<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YOLO WebSocket Stream</title>
  <style>
    body { background: #222; color: #fff; text-align: center; font-family: sans-serif; }
    canvas { border: 2px solid #0f0; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>YOLO WebSocket Stream</h1>
  <canvas id="videoCanvas" width="640" height="480"></canvas>

  <script>
    const canvas = document.getElementById('videoCanvas');
    const ctx = canvas.getContext('2d');
    let ws;

    function connect() {
      ws = new WebSocket('ws://localhost:8765');

      ws.onmessage = function(event) {
        const img = new Image();
        img.src = 'data:image/jpeg;base64,' + event.data;
        img.onload = function() {
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        }
        img.onerror = function() {
          console.log("❌ Error loading image frame");
        }
      }

      ws.onopen = () => {
        console.log("✅ Connected to YOLO WebSocket server");
        document.body.style.background = '#222';
      }
      
      ws.onclose = () => {
        console.log("❌ Disconnected from server");
        document.body.style.background = '#444';
        // Try to reconnect after 3 seconds
        setTimeout(connect, 3000);
      }
      
      ws.onerror = (error) => {
        console.log("❌ WebSocket error:", error);
        document.body.style.background = '#666';
      }
    }

    // Start connection
    connect();
  </script>
</body>
</html>
